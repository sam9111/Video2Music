
import os
from transformers import pipeline

stopwords = ['does',
             'eight',
             "shouldn't",
             'above',
             'bottom',
             'first',
             'whoever',
             'because',
             'she',
             'forty',
             'else',
             'somehow',
             'even',
             'next',
             'yours',
             'serious',
             'fifteen',
             'to',
             'unless',
             "couldn't",
             'wherever',
             'whole',
             'doing',
             'should',
             'the',
             'otherwise',
             'whereby',
             'much',
             't',
             "'s",
             're',
             'get',
             'latterly',
             'whence',
             'us',
             'found',
             'bill',
             'someone',
             "wouldn't",
             'be',
             'although',
             'top',
             'has',
             'front',
             "hadn't",
             'me',
             'our',
             'somewhere',
             'must',
             'used',
             'put',
             'here',
             'was',
             'herein',
             "she's",
             'couldn',
             'during',
             "you'll",
             'your',
             '’re',
             'often',
             'yet',
             'where',
             'more',
             'having',
             'in',
             'thereupon',
             'been',
             'other',
             'ltd',
             'formerly',
             'of',
             'over',
             'please',
             'with',
             'nowhere',
             'something',
             'can',
             'about',
             'then',
             'ain',
             'detail',
             'rather',
             'twenty',
             'thick',
             'towards',
             'but',
             "aren't",
             'any',
             'might',
             'without',
             'using',
             'before',
             'below',
             'off',
             "didn't",
             'under',
             'enough',
             'seemed',
             'alone',
             "doesn't",
             'will',
             'down',
             'we',
             'anything',
             'y',
             'a',
             'after',
             'hence',
             'being',
             'their',
             'into',
             'interest',
             'mostly',
             'at',
             'noone',
             'those',
             'twelve',
             'by',
             'always',
             'within',
             'mine',
             'last',
             'part',
             'further',
             'hers',
             'ours',
             'four',
             'an',
             'eg',
             'weren',
             'made',
             'namely',
             'whenever',
             'is',
             'third',
             'besides',
             'whereupon',
             'nine',
             'elsewhere',
             '‘ll',
             'how',
             'who',
             'nevertheless',
             'empty',
             '’s',
             'done',
             'neither',
             'afterwards',
             '’m',
             'most',
             'when',
             'keep',
             'nobody',
             'both',
             'anywhere',
             'herself',
             'thence',
             'make',
             'wasn',
             'shouldn',
             'etc',
             'thin',
             'whereas',
             'll',
             'ca',
             'its',
             'via',
             'still',
             'everything',
             'inc',
             "weren't",
             'go',
             'isn',
             'see',
             'latter',
             'whose',
             'they',
             'back',
             'becomes',
             'among',
             'it',
             'are',
             'eleven',
             "haven't",
             'you',
             'co',
             'hereupon',
             'theirs',
             'own',
             'sincere',
             'themselves',
             'n‘t',
             'except',
             'therefore',
             'amoungst',
             'none',
             'he',
             '’d',
             'these',
             'either',
             'such',
             'don',
             "should've",
             'find',
             'hadn',
             'onto',
             'while',
             'every',
             "'d",
             'until',
             'amount',
             'between',
             "don't",
             'didn',
             'give',
             "'ve",
             'sometimes',
             'o',
             'call',
             'each',
             'itself',
             'already',
             'nor',
             '’ll',
             'had',
             'un',
             'some',
             'ie',
             'doesn',
             "it's",
             'ten',
             'out',
             'what',
             'full',
             'him',
             'move',
             'along',
             "wasn't",
             "you'd",
             'take',
             'ma',
             '‘s',
             'since',
             've',
             'did',
             "hasn't",
             'perhaps',
             'sixty',
             'one',
             'beside',
             'from',
             'needn',
             'though',
             'around',
             "'ll",
             'would',
             'thru',
             'his',
             'ourselves',
             'seems',
             'whereafter',
             'against',
             'this',
             'across',
             'whatever',
             'many',
             'whom',
             'everyone',
             'on',
             'system',
             "isn't",
             'just',
             'anyhow',
             'mustn',
             'hasn',
             'yourselves',
             "mustn't",
             'were',
             'n’t',
             'show',
             'regarding',
             'de',
             'throughout',
             'nothing',
             'hereby',
             'hasnt',
             'again',
             'thereby',
             'very',
             'mill',
             'haven',
             'toward',
             'i',
             's',
             'indeed',
             'm',
             'have',
             'become',
             'due',
             'than',
             'am',
             'through',
             'anyone',
             'name',
             'well',
             '’ve',
             'only',
             'do',
             'less',
             'really',
             'however',
             'former',
             'almost',
             'himself',
             "you've",
             'beforehand',
             "n't",
             'won',
             'therein',
             "won't",
             'moreover',
             "'re",
             'meanwhile',
             'ever',
             'two',
             'amongst',
             'so',
             'side',
             'them',
             'cry',
             'myself',
             "mightn't",
             'seeming',
             'if',
             'together',
             'per',
             'once',
             "shan't",
             'why',
             'for',
             'all',
             "needn't",
             'describe',
             'few',
             'my',
             'cant',
             'wouldn',
             'there',
             'no',
             'cannot',
             'fifty',
             'thereafter',
             'aren',
             'fill',
             '‘d',
             'six',
             'too',
             'thus',
             'behind',
             '‘ve',
             'mightn',
             'quite',
             'anyway',
             'beyond',
             'others',
             'that',
             '‘m',
             'another',
             "you're",
             'not',
             'hereafter',
             'd',
             'her',
             'yourself',
             'now',
             "'m",
             'wherein',
             'becoming',
             'also',
             'least',
             'con',
             'and',
             'fire',
             'whether',
             'whither',
             'may',
             'upon',
             'say',
             'several',
             'became',
             'as',
             'three',
             'hundred',
             'sometime',
             'which',
             'up',
             'everywhere',
             'or',
             '‘re',
             'could',
             'shan',
             'never',
             'various',
             "that'll",
             'couldnt',
             'same',
             'seem',
             'five']


def describe_images():
    image_to_text = pipeline(
        "image-to-text", model="nlpconnect/vit-gpt2-image-captioning")

    # create captions for images in frames
    frames_path = "./frames"

    descriptions = []

    for image in os.listdir(frames_path):

        image_path = f"{frames_path}/{image}"

        description = image_to_text(image_path)[0]['generated_text']

        descriptions.append(description)

    descriptions = ' '.join(descriptions)

    descriptions = descriptions.split(' ')

    descriptions = list(set(descriptions))

    descriptions = [word for word in descriptions if word not in stopwords]

    descriptions = ' '.join(descriptions)

    print("Descriptions: ", descriptions)

    return descriptions
